Fitting Text AutoML
Train_df with labels and class instance counts:
 label
2    19742
1     2818
0     2425
Name: count, dtype: int64
train_df after split, original class counts 3
train_df after split, original class counts [ 1940  2254 15794]
class weights [10.30309278  8.86779059  1.26554388] <class 'numpy.ndarray'>
normalized class weights [1.51245998 1.30176236 0.18577766] <class 'numpy.ndarray'>
Train size: 19988, Validation size: 4997, Test size: 12141
cuda
Loading and preparing data...
Train class distribution: Counter({2: 15794, 1: 2254, 0: 1940})
Val class distribution: Counter({2: 3948, 1: 564, 0: 485})
Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Using class weights: tensor([1.5125, 1.3018, 0.1858], device='cuda:0')
Epoch 1, Loss: 444.2098, Train Accuracy: 0.7868
Epoch 1, Validation Accuracy: 0.7901
Epoch 2, Loss: 413.7571, Train Accuracy: 0.7902
Epoch 2, Validation Accuracy: 0.7901
Epoch 3, Loss: 411.9013, Train Accuracy: 0.7902
Epoch 3, Validation Accuracy: 0.7901
Final Validation Accuracy: 0.7901
Training complete
Writing predictions to disk
Saved validation score at /work/dlclarge2/celikh-nr1-ayca/AutoML-Final_Project/results/dataset=amazon/seed=42/score.yaml
Saved test prediction at /work/dlclarge2/celikh-nr1-ayca/AutoML-Final_Project/results/dataset=amazon/seed=42/test_preds.npy
Accuracy on test set: 0.7902149740548554
Classification Report:
/work/dlclarge2/celikh-nr1-ayca/miniconda3/envs/automl/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/work/dlclarge2/celikh-nr1-ayca/miniconda3/envs/automl/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/work/dlclarge2/celikh-nr1-ayca/miniconda3/envs/automl/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])

              precision    recall  f1-score   support

           0       0.00      0.00      0.00      1178
           1       0.00      0.00      0.00      1369
           2       0.79      1.00      0.88      9594

    accuracy                           0.79     12141
   macro avg       0.26      0.33      0.29     12141
weighted avg       0.62      0.79      0.70     12141
